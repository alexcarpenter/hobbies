{% extends 'layouts/default.njk' %}
{% import "components.njk" as components %}

{% set previousPost = collections.posts | getPreviousCollectionItem(page) %}
{% set nextPost = collections.posts | getNextCollectionItem(page) %}

{% block main %}
  <header>
    {# <a class="mb-1 inline-flex items-center text-gray-700 hover:underline" href="">Purchase on Amazon <svg class="ml-1" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="5" y1="12" x2="19" y2="12"></line><polyline points="12 5 19 12 12 19"></polyline></svg></a> #}
    <h1 class="text-green-700 text-3xl md:text-4xl lg:text-5xl font-bold leading-tight mw-65ch">{{ title }}</h1>
    {% if description %}
      <p class="text-xl text-gray-700">{{ description | markdownify_inline | safe }}</p>
    {% endif %}
    {% if youtubeId %}
      <div class="mt-8">
        {{ components.youtube({id: youtubeId }) }}
      </div>
    {% elseif thumbnail %}
      <div class="mt-8 relative">
        {% if gallery %}
          <button class="absolute right-0 bottom-0 p-3 bg-green-700 hover:bg-green-900 focus:bg-green-900 text-white flex items-center justify-center z-10" data-lightbox-show>
            <span class="hidden sm:inline mr-2">View gallery</span>
            <svg class="flex-shrink-0" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-maximize-2"><polyline points="15 3 21 3 21 9"></polyline><polyline points="9 21 3 21 3 15"></polyline><line x1="21" y1="3" x2="14" y2="10"></line><line x1="3" y1="21" x2="10" y2="14"></line></svg>
          </button>
        {% endif %}
        {{ components.image({ src: thumbnail, alt: ""}) }}
      </div>
    {% endif %}
  </header>
  <div class="prose mt-8">
    {# <p class="text-xl font-bold text-green-700">Raiting: 6/10</p> #}
    {# {% if pros and cons %}
      {{ components.prosCons({
        pros: pros,
        cons: cons
      })}}
    {% endif %} #}
    {{ content | markdownify | safe }}
  </div>
  <div class="mt-8 pt-8 border-t border-gray-200 mw-65ch">
    <nav class="flex flex-col sm:flex-row justify-between">
      {% if previousPost %}
      <div class="mb-4 sm:mb-0">
        <p class="font-bold">Previous post</p>
        <a class="text-green-700 hover:underline" href="{{ previousPost.url }}">{{ previousPost.data.title }}</a>
      </div>
      {% endif %}
      {% if nextPost %}
      <div class="sm:ml-auto">
        <p class="font-bold sm:text-right">Next post</p>
        <a class="text-green-700 hover:underline" href="{{ nextPost.url }}">{{ nextPost.data.title }}</a>
      </div>
      {% endif %}
    </nav>
  </div>
{% endblock %}

{% block pageEnd %}
  <div class="fixed top-0 left-0 w-screen h-screen z-50 hidden" data-lightbox>
    <header class="fixed top-0 left-0 right-0 pl-4 flex justify-between items-center z-30">
      <h2 class="sr-only" tabindex="0">{{ title }} gallery</h2>
      <button class="relative ml-auto w-12 h-12 cursor-pointer flex items-center justify-center z-20" data-lightbox-hide>
        <span class="sr-only">Close</span>
        <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
      </button>
    </header>
    <nav class="absolute top-50 left-0 right-0 flex justify-between pointer-events-none z-20">
      <button class="pointer-events-auto w-12 h-12 bg-green-700 hover:bg-green-900 text-white cursor-pointer flex items-center justify-center" data-lightbox-previous>
        <span class="sr-only">Previous</span>
        <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>
      </button>
      <button class="pointer-events-auto w-12 h-12 bg-green-700 hover:bg-green-900 text-white cursor-pointer flex items-center justify-center" data-lightbox-next>
        <span class="sr-only">Next</span>
        <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="5" y1="12" x2="19" y2="12"></line><polyline points="12 5 19 12 12 19"></polyline></svg>
      </button>
    </nav>
    <div class="absolute top-50 left-0 right-0 flex items-center justify-center z-10 pointer-events-none">
      <div class="max-w-screen-md pointer-events-auto">
        {% for image in gallery %}
          <img class="hidden" src="{{ image }}" alt="{{ title }} - {{ loop.index }}" loading="lazy">
        {% endfor %}
      </div>
    </div>
    <div class="absolute top-0 left-0 w-screen h-screen bg-black bg-opacity-75 z-0" data-lightbox-hide></div>
  </div>
{% endblock %}